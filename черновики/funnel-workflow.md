# –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –≤–æ—Ä–æ–Ω–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏

## üéØ –§–∏–ª–æ—Å–æ—Ñ–∏—è

**–í–æ—Ä–æ–Ω–∫–∞ = –ø—Ä–æ—Å—Ç–æ–π –ø—É—Ç—å –æ—Ç —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫ –≥–æ—Ç–æ–≤–æ–π –∑–∞–ø–∏—Å–∏**

```
–í–•–û–î ‚Üí –ì–û–†–õ–´–®–ö–û ‚Üí –í–´–•–û–î
```

---

## üì• –®–ê–ì 1: –í–•–û–î (Input Sources)

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç **–∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**:

1. **üì∑ –§–æ—Ç–æ** - —á–µ–∫, —Å–∫—Ä–∏–Ω—à–æ—Ç, —Ñ–æ—Ç–æ –º–µ—Å—Ç–∞/–µ–¥—ã/–≤–µ—â–∏
2. **üîó URL** - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ç–æ–≤–∞—Ä/–º–µ—Å—Ç–æ/—É—Å–ª—É–≥—É
3. **‚úçÔ∏è –¢–µ–∫—Å—Ç** - —Å–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç ("–ø–æ—Ç—Ä–∞—Ç–∏–ª 500 –Ω–∞ —Ç–∞–∫—Å–∏")
4. **üéØ –ö–∞—Å—Ç–æ–º** - —Ä—É—á–Ω–æ–π –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–±–µ–∑ AI)

**–í–∞–∂–Ω–æ:** –ù–∞ —ç—Ç–æ–º —à–∞–≥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–∫–∞–∑–∞—Ç—å **–Ω–∞–º–µ—Ä–µ–Ω–∏–µ** (–¥–ª—è —Ñ–æ—Ç–æ/URL):

- –ü–æ–∫—É–ø–∫–∞ / –ü–µ—Ä–µ–≤–æ–¥ / –•–æ—á—É –∫—É–ø–∏—Ç—å / –•–æ—á—É –ø–æ–π—Ç–∏ / –ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å / –î–æ–∫—É–º–µ–Ω—Ç

---

## üîÑ –®–ê–ì 2: –ì–û–†–õ–´–®–ö–û (Processing Funnel)

### 2.1 AI –ê–Ω–∞–ª–∏–∑ (–µ—Å–ª–∏ –Ω–µ –∫–∞—Å—Ç–æ–º)

**–í—Ö–æ–¥:** –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ + –Ω–∞–º–µ—Ä–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ü—Ä–æ—Ü–µ—Å—Å:**

1. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ AI —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –Ω–∞–º–µ—Ä–µ–Ω–∏—è
2. AI –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ action, object, title, amount, ... }`

**–í—ã—Ö–æ–¥:** `AIAnalysisResult`

### 2.2 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞

**–í—Ö–æ–¥:** `AIAnalysisResult` (action + object)

**–ü—Ä–æ—Ü–µ—Å—Å:**

```
AI Result ‚Üí –ü–æ–∏—Å–∫ —Ä–µ—Ü–µ–ø—Ç–∞ –ø–æ action+object
```

**–î–≤–∞ –ø—É—Ç–∏:**

#### ‚úÖ –ü—É—Ç—å A: –†–µ—Ü–µ–ø—Ç –Ω–∞–π–¥–µ–Ω

- –ü–µ—Ä–µ—Ö–æ–¥ —Å—Ä–∞–∑—É –≤ **–®–ê–ì 3: –§–û–†–ú–ê**
- –í—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –∏–∑ AI

#### ‚ö†Ô∏è –ü—É—Ç—å B: –†–µ—Ü–µ–ø—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω

- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ **–±–∞–∑–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** –∏–∑ `object`
- –ü–µ—Ä–µ—Ö–æ–¥ –≤ **–®–ê–ì 2.5: –£–¢–û–ß–ù–ï–ù–ò–ï**

### 2.3 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥)

**–í–º–µ—Å—Ç–æ —Ö–∞—Ä–¥–∫–æ–¥–∞** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º **–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é recipes**

```typescript
// –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞:
function getCategoryFromObject(object: Object): string {
  // –ò—â–µ–º –≤—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã —Å —ç—Ç–∏–º object
  const recipesWithObject = recipes.filter(r => r.object === object);

  if (recipesWithObject.length === 0) {
    return 'other';
  }

  // –ë–µ—Ä–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø–µ—Ä–≤–æ–≥–æ —Ä–µ—Ü–µ–ø—Ç–∞ (–∏–ª–∏ —Å–∞–º—É—é —á–∞—Å—Ç—É—é)
  const categories = recipesWithObject.map(r => r.category).filter(Boolean);
  return categories[0] || 'other';
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- ‚úÖ –ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞ - –≤—Å–µ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ä–µ—Ü–µ–ø—Ç–æ–≤
- ‚úÖ –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥–µ

### 2.5 –£—Ç–æ—á–Ω–µ–Ω–∏–µ (Refine)

**–í—Ö–æ–¥:** –ë–∞–∑–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã –∏–∑ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –Ω—É–∂–Ω—ã–π

**–í—ã—Ö–æ–¥:** –í—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ—Ü–µ–ø—Ç ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –≤ **–®–ê–ì 3**

---

## üìã –®–ê–ì 3: –§–û–†–ú–ê (Final Card)

**–í—Ö–æ–¥:** –†–µ—Ü–µ–ø—Ç + AI —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å) + attachments

**–ü—Ä–æ—Ü–µ—Å—Å:**

1. –§–æ—Ä–º–∞ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ `initialData` (–∏–∑ AI —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞)
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
3. Attachments –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –µ—â–µ

**–í—ã—Ö–æ–¥:** –ì–æ—Ç–æ–≤–∞—è –∑–∞–ø–∏—Å—å ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

---

## üó∫Ô∏è –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥

### –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:

```typescript
// –•–∞—Ä–¥–∫–æ–¥ –≤ –∫–æ–¥–µ
const objectToCategory: Record<string, string> = {
  money: 'money',
  item: 'items',
  place: 'places',
  // ...
};
```

### –ù–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ:

**1. –ú–∞–ø–ø–∏–Ω–≥ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é recipes:**

```typescript
// –í recipes.default.json –∏–ª–∏ –≤ –±–∞–∑–µ
{
  "objectCategoryMap": {
    "money": "money",
    "item": "items",
    "place": "places",
    "food": "food",
    "service": "services",
    "wish": "wishes",
    "task": "wishes",
    "note": "notes" // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –Ω–æ –º–æ–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å —á–µ—Ä–µ–∑ —Ç–µ–≥–∏
  }
}
```

**2. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –º–∞–ø–ø–∏–Ω–≥ –∏–∑ recipes:**

```typescript
function getCategoryFromObject(object: Object): string {
  // –ò—â–µ–º —Ä–µ—Ü–µ–ø—Ç—ã —Å —ç—Ç–∏–º object
  const recipes = getRecipesByObject(object);

  if (recipes.length === 0) {
    return 'other';
  }

  // –ë–µ—Ä–µ–º —Å–∞–º—É—é —á–∞—Å—Ç—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
  const categoryCounts = new Map<string, number>();
  recipes.forEach(r => {
    if (r.category) {
      categoryCounts.set(r.category, (categoryCounts.get(r.category) || 0) + 1);
    }
  });

  const mostCommon = Array.from(categoryCounts.entries())
    .sort((a, b) => b[1] - a[1])[0];

  return mostCommon?.[0] || 'other';
}
```

**3. –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥:**

```typescript
// –í –∫–æ–Ω—Ñ–∏–≥–µ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞
{
  "categoryRules": [
    {
      "object": "note",
      "condition": {
        "tags": ["–æ–ø—ã—Ç", "–≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ"],
        "intent": "liked"
      },
      "category": "experience"
    }
  ]
}
```

---

## üìä –°—Ö–µ–º–∞ –≤–æ—Ä–æ–Ω–∫–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         –í–•–û–î (Input Sources)            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ –§–æ—Ç–æ ‚îÇ ‚îÇ URL  ‚îÇ ‚îÇ –¢–µ–∫—Å—Ç‚îÇ ‚îÇ–ö–∞—Å—Ç–æ–º‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      –ì–û–†–õ–´–®–ö–û (Processing)              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  1. AI –ê–Ω–∞–ª–∏–∑ (–µ—Å–ª–∏ –Ω–µ –∫–∞—Å—Ç–æ–º)    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ     ‚Üí AIAnalysisResult            ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  2. –ü–æ–∏—Å–∫ —Ä–µ—Ü–µ–ø—Ç–∞                 ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ     action+object ‚Üí Recipe?       ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ           ‚Üì              ‚Üì              ‚îÇ
‚îÇ      ‚úÖ –ù–∞–π–¥–µ–Ω      ‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω        ‚îÇ
‚îÇ           ‚Üì              ‚Üì              ‚îÇ
‚îÇ      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ
‚îÇ      ‚îÇ –§–û–†–ú–ê  ‚îÇ    ‚îÇ –£–¢–û–ß–ù–ï–ù–ò–ï    ‚îÇ     ‚îÇ
‚îÇ      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ (–∫–∞—Ç–µ–≥–æ—Ä–∏—è)  ‚îÇ     ‚îÇ
‚îÇ                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ
‚îÇ                           ‚Üì             ‚îÇ
‚îÇ                      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ                      ‚îÇ –§–û–†–ú–ê  ‚îÇ         ‚îÇ
‚îÇ                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      –í–´–•–û–î (Final Card)                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  –§–æ—Ä–º–∞ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  + Attachments                    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  + –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ                 ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                    ‚Üì                     ‚îÇ
‚îÇ              –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1. –£–ø—Ä–æ—Å—Ç–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥

–°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```typescript
// src/lib/config/category-mapping.ts
export function getCategoryFromObject(
  object: Object,
  intent?: string,
  tags?: string[]
): string {
  // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –º–∞–ø–ø–∏–Ω–≥–∞
  const configMap = getObjectCategoryMap(); // –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

  // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
  const rule = findMatchingRule(object, intent, tags);
  if (rule) return rule.category;

  // 3. –ò—â–µ–º –≤ recipes
  const recipes = getRecipesByObject(object);
  if (recipes.length > 0) {
    return getMostCommonCategory(recipes);
  }

  // 4. –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—ã–π –º–∞–ø–ø–∏–Ω–≥
  return configMap[object] || 'other';
}
```

### 2. –£–ø—Ä–æ—Å—Ç–∏—Ç—å workflow

```typescript
// –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ handleAISuccess
function handleAISuccess(result: AIAnalysisResult, file?: File) {
  lastAIResult = result;

  // 1. –ò—â–µ–º —Ä–µ—Ü–µ–ø—Ç
  const recipe = getRecipeBySemantic(result.action, result.object);

  if (recipe) {
    // ‚úÖ –ü—Ä—è–º–æ–π –ø—É—Ç—å: —Ä–µ—Ü–µ–ø—Ç –Ω–∞–π–¥–µ–Ω
    selectedRecipe = recipe;
    step = 'form';
    if (file) attachments = [file];
    return;
  }

  // 2. –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥)
  const category = getCategoryFromObject(
    result.object,
    currentIntent,
    result.tags
  );

  // 3. –ü–µ—Ä–µ—Ö–æ–¥ –≤ —É—Ç–æ—á–Ω–µ–Ω–∏–µ
  selectedCategory = category;
  step = 'refine';
  if (file) attachments = [file];
}
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

1. **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - —á–µ—Ç–∫–∏–µ —à–∞–≥–∏ –≤–æ—Ä–æ–Ω–∫–∏
2. **–ì–∏–±–∫–æ—Å—Ç—å** - –º–∞–ø–ø–∏–Ω–≥ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥
3. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
4. **–ü–æ–Ω—è—Ç–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π —à–∞–≥ –∏–º–µ–µ—Ç —á–µ—Ç–∫—É—é —Ü–µ–ª—å

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –°–æ–∑–¥–∞—Ç—å `category-mapping.ts` —Å —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–æ–π
2. –í—ã–Ω–µ—Å—Ç–∏ –º–∞–ø–ø–∏–Ω–≥ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (JSON)
3. –£–ø—Ä–æ—Å—Ç–∏—Ç—å `determineCategoryFromAIResult`
4. –û–±–Ω–æ–≤–∏—Ç—å workflow –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –≤–æ—Ä–æ–Ω–∫–µ
