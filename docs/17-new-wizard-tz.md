# ТЗ: оформление экрана `/new` (2 этапа UI/UX)

## Цель
Сделать понятный двухэтапный визард создания записи: быстрый ввод → структурированный черновик → подтверждение. Экран должен минимизировать когнитивную нагрузку и помогать пользователю быстро зафиксировать событие.

## Общие требования (для обоих этапов)

- **Mobile‑first**, вертикальная композиция, доступ к основным действиям «большим пальцем».
- **Прогресс**: индикатор «Шаг 1/2» в шапке.
- **Автосохранение**: черновик сохраняется при каждом ключевом изменении.
- **Управление клавиатурой**: корректные таб‑переходы, типы полей (email/number/date).
- **Состояния**: loading, empty, error, offline.
- **Доступность**: контраст, крупные кликабельные зоны, фокус‑стили.
- **Универсальные действия**: «Отмена» (с подтверждением), «Сохранить черновик», «Назад».

---

## Этап 1. Быстрый ввод (сырой контент)

### UX‑задачи
- Снять барьер начала: минимальный набор обязательных действий.
- Максимально быстро принять ввод из любых источников (текст, голос, ссылка, фото/скан, файлы, QR/штрихкод).
- Подготовить сырой контент для AI‑черновика (без ручного контекста).

### UI‑структура
1. **Шапка**
   - Название: «Новая запись».
   - Индикатор шага: «Шаг 1 из 2».
   - Кнопка «Закрыть» с предупреждением о несохранённых изменениях.

2. **Главное поле ввода**
   - Многострочный input с плейсхолдером: «Что произошло? Можно просто текстом…».
   - Поддержка вставки ссылок и распознавание типа контента.
   - Состояния: фокус, заполнено, ошибка (если пусто при переходе).

3. **Быстрые источники**
   - Иконки/кнопки: «Голос», «Фото/скан», «Файл», «Ссылка», «QR/штрихкод».
   - При выборе источника — inline‑подсказка по формату.
   - Для фото/URL можно спросить намерение (покупка/документ/место и т.п.) для лучшей классификации.
   - Можно комбинировать источники: текст + фото/скан + файл + ссылка.
   - Отображение вложений: превью изображений и список файлов под полем ввода.
   - Лимит изображений: до 3 шт. (остальные — как файлы или предупреждение).

4. **CTA‑зона**
   - Основная кнопка: «Продолжить» (disabled при пустом вводе).
   - Вторичная: «Сохранить черновик».

### UX‑детали
- **Лёгкий старт**: фокус сразу в поле ввода.
- **Ненавязчивые подсказки**: «Можно скопировать чек, ссылку или заметку».
- **Минимум обязательных полей**: только сам контент.
- **Ошибки**: если поле пустое — короткая подсказка рядом с CTA.
- **Принцип этапов**: шаг 1 — только контент, шаг 2 — AI‑распознавание и ручное дополнение.
- **Источник данных**: на шаге 2 показываем, что было источником (текст/фото/URL/файл).

---

## Этап 2. AI‑черновик и подтверждение

### UX‑задачи
- Превратить ввод в структурированную запись.
- Дать контроль: пользователь редактирует и подтверждает.
- Снизить тревожность: показать, как ИИ понял ввод.
- Обеспечить доступ к ручному выбору категории/рецепта, если ИИ не уверен.

### UI‑структура
1. **Шапка**
   - «Шаг 2 из 2».
   - Кнопка «Назад» (возвращает на ввод с сохранением данных).

2. **Блок «Что получилось»**
   - Карточка со структурой: заголовок, дата/время, категория → подкатегория, участники/место, теги.
   - Визуальная метка «AI‑черновик».
   - Инлайн‑редактирование ключевых полей.
   - Опциональные поля, распознанные ИИ, с возможностью быстро добавить/удалить.
   - Кнопка «Добавить поле» (ручное добавление нужных полей, которых ИИ не нашёл).
   - Пользователь может удалить любое предложенное поле.
   - Быстрый выбор категории/рецепта, если ИИ не уверен.
   - Переопределение `action + object` (перестраивает набор полей).

3. **Блок «Детали»**
   - Список распознанных деталей/позиций (если есть чек/список), итог по списку.
   - Возможность удалить или исправить отдельные элементы.
   - Если ИИ не уверен — минимальная форма для ручной правки ключевых полей.

4. **Блок «Эмоции/настроение» (опционально)**
   - Чипы эмоций/настроения и быстрый ввод заметки по ощущениям.
   - Если ИИ распознал эмоцию — показать как предложенную.

5. **Блок «Напоминание»**
   - Отдельная секция «Добавить напоминание» с датой/временем и текстом уведомления.
   - Если ИИ предложил напоминание — показать как черновик с возможностью редактировать/отклонить.

6. **Контроль качества**
   - Плашка уверенности (например: «Высокая уверенность» / «Нужна проверка»).
   - Подсветка полей с низкой уверенностью.
   - Подсказка: «ИИ предлагает, но решение — за пользователем».

7. **CTA‑зона**
   - Основная кнопка: «Подтвердить и сохранить».
   - Вторичные: «Редактировать вручную», «Вернуться к вводу».

### UX‑детали
- **Прозрачность ИИ**: короткая подсказка «Проверьте важные поля перед сохранением».
- **Редактирование на месте**: без переходов на отдельные экраны.
- **Обратная связь**: подтверждение успеха + переход к карточке записи.
- **Напоминания**: ИИ может предложить, но пользователь подтверждает или отклоняет.
- **Обязательные поля**: если по сценарию требуются `title/date/amount/person`, показывать подсказки и не давать сохранить без заполнения.

---

## Нефункциональные требования

- **Производительность**: переход к этапу 2 ≤ 2 сек (при генерации — скелетон).
- **Offline‑режим**: сохранение черновика и возможность завершить позже.
- **Локализация**: текстовые элементы через словарь.

## Критерии готовности

- Пользователь может создать запись, пройдя 2 шага без обязательных дополнительных полей.
- Все состояния (empty/loading/error/offline) отрисованы и протестированы.
- Визуально различимы первичная и вторичная кнопки на обоих этапах.
