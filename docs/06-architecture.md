# 06 — Архитектура (FastAPI + Svelte 5 + PWA)

## Общая схема

- **Frontend:** Svelte 5, PWA, offline‑first, IndexedDB/LocalStorage для кэша.
- **Backend:** FastAPI + фоновые задачи (Celery/RQ).
- **Хранилище:** PostgreSQL (JSONB, pgvector), файловое хранилище (S3/MinIO).
- **AI‑слой:** анализ текста/фото/URL и семантический поиск.

## Архитектурные принципы

- **Source of truth** — backend.
- **Offline‑first** — локальное хранение с синхронизацией.
- **Конфиг‑ориентированность** — формы и рецепты управляются конфигом.

## Основные компоненты backend

- `entries` — события
- `lists` — списки записей (чеки, наборы)
- `recipes` — пользовательские рецепты
- `reminders` — напоминания
- `groups` — совместные пространства
- `files` — вложения
- `ai` — анализ и семантический поиск

## Синхронизация

- локальные записи создаются офлайн;
- фоновые задачи синхронизируют изменения;
- при конфликте — стратегия «последнее изменение с логом».
Списки и группы синхронизируются тем же механизмом, чтобы сохранять целостность связей.

## Безопасность и приватность

- шифрование вложений на стороне клиента (по возможности);
- авторизация (JWT/WebAuthn) после MVP;
- экспорт/удаление всех данных пользователем.

## Конфигурация рецептов

- рецепты и поля приходят из backend через `/api/config/*`;
- фронт строит форму динамически;
- изменение рецепта не требует деплоя фронта.
